# Setup Instructions

To run the scripts in this directory, you need to set up your environment variables.

## 1. Create `.env` file

Copy the `.env.example` file from the project root and fill in your actual credentials:

```bash
cp ../.env.example .env
```

Then edit `.env` and add your real secrets:
- `SUPABASE_URL`: Your Supabase project URL
- `SUPABASE_SERVICE_ROLE_KEY`: Your Supabase service role key (from dashboard)
- `OPENAI_API_KEY`: Your OpenAI API key

## 2. Load environment variables before running

### On macOS/Linux:
```bash
set -a
source ../.env
set +a
python SupabaseUpload.py
```

### On Windows (PowerShell):
```powershell
Get-Content ..\.env | ForEach-Object {
    if ($_ -and !$_.StartsWith("#")) {
        $key, $value = $_.Split("=")
        [System.Environment]::SetEnvironmentVariable($key, $value)
    }
}
python SupabaseUpload.py
```

### On Windows (Command Prompt):
```cmd
for /f "delims== tokens=1,2" %%A in (..\..env) do (
    if not "%%A"=="" if not "%%A:~0,1%"=="#" set %%A=%%B
)
python SupabaseUpload.py
```

## 3. Never commit `.env` file

The `.env` file is already in `.gitignore` and will never be pushed to the repository. Only `.env.example` should be committed.

## File Overview

- **ChunkingScript.py**: Takes the Tangerine Bot Knowledge Base markdown and splits it into semantic chunks with metadata (department, doc_type, etc.)
- **SupabaseUpload.py**: Takes the JSON chunks from ChunkingScript and uploads them to Supabase with embeddings generated by OpenAI

## Running the scripts

1. First, run the chunking script (no environment variables needed):
   ```bash
   python ChunkingScript.py
   ```
   This generates `tangerine_chunks.json`

2. Then, set up your environment and run the upload script:
   ```bash
   # Load .env and then run
   python SupabaseUpload.py
   ```
   This uploads the chunks to Supabase with embeddings.
